<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="clear 航">
<meta property="og:type" content="website">
<meta property="og:title" content="why are you so happy">
<meta property="og:url" content="https://skydh.github.io/page/2/index.html">
<meta property="og:site_name" content="why are you so happy">
<meta property="og:description" content="clear 航">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="why are you so happy">
<meta name="twitter:description" content="clear 航">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://skydh.github.io/page/2/"/>





  <title>why are you so happy</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">why are you so happy</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">clear 航</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/05/27/eclipce 奇葩缺包异常/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/27/eclipce 奇葩缺包异常/" itemprop="url">eclipse奇葩缺包异常</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-27T11:11:40+08:00">
                2019-05-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>　　早上一来，打开工程，直接报错Missing artifact jdk.tools:jdk.tools:jar:1.8，但是显然其他同事没有报错，网上搜索，需要添加这个包的依赖，不采取。</p>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>　　tools.jar包是JDK自带的，pom.xml中以来的包隐式依赖tools.jar包，而tools.jar并未在库中。找到答案。eclipse启动的jre不是开发用的jre，而你编译报错则是，在eclipse的jre里面没有找到这个包，我们切换eclipse依赖的jre即可。方法：找到eclipse.ini，在-vmargs这个参数前面添加：<br>　　-vm<br>　　C:\Program Files\Java\jdk1.8.0_172\jre\bin\server\jvm.dll<br>　　即可。重启eclipse，maven更新即可。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/05/20/大表的全表扫描/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/20/大表的全表扫描/" itemprop="url">大表的全表扫描</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-20T20:11:31+08:00">
                2019-05-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>　　你的服务器内存2G,你全表查询一个10g的表，内存会不会炸了。</p>
<h2 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h2><p>　　不会。逻辑如下，语句，select * from t；服务端不会存放完整的结果集，其流程和流很类似。<br>　　１.获取一行，写到net_buffer中。这个值由参数net_buffer_length决定，默认16k。<br>　　２.重复获取行，直到，写满net_buffer<br>　　３.若发送成功，就清空net_buffer,然后取下一行，写入搭配net_buffer。<br>　　４.如果发送函数返回EAGAIN,或者WSAEWOULDBLOCK。就表示本地网络栈满了，进入等待，直到可以重写，再继续发送。</p>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><p>　　-quick：mysql_use_result方法，这个方法是读一行，处理一行。默认的话mysql_store_result这个接口。这个是把结果保存到本地内存。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/05/15/上传jar到私服命令模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/15/上传jar到私服命令模式/" itemprop="url">上传jar到私服命令模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-15T10:41:37+08:00">
                2019-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="命令如下"><a href="#命令如下" class="headerlink" title="命令如下"></a>命令如下</h2><p>　　mvn deploy:deploy-file -DgroupId=net.sf.squirrel-sql.plugins -DartifactId=greenplum -Dversion=3.5.0 -Dpackaging=jar -Dfile=C:\Users\Lenovo.m2\repository\net\sf\squirrel-sql\plugins\greenplum\3.5.0\greenplum-3.5.0.jar -Durl=<a href="http://maven.×××.com/nexus/content/repositories/thirdparty/" target="_blank" rel="noopener">http://maven.×××.com/nexus/content/repositories/thirdparty/</a> -DrepositoryId=3rd.nexus –settings  D:\maven\apache-maven-3.5.0\conf\settings.xml</p>
<p>　　其中-DgroupId 为上传的jar的groupId</p>
<p>　　-DartifactId 为上传的jar的artifactId</p>
<p>　　-Dversion 为上传的jar的需要被依赖的时候的版本号</p>
<p>　　然后是-Dpackaging为jar，-Dfile为jar包路径 </p>
<p>　　-Durl 为要上传的路径，可以通过以下方式获取到</p>
<p>　　-DrepositoryId 为repository的唯一标示，和setting.xml里面server相同<br>　　　<br>　　–settings 指定配置文件</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/04/24/mysql 主从/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/24/mysql 主从/" itemprop="url">mysql 主从</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-24T19:10:24+08:00">
                2019-04-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="mysql主从基本原理"><a href="#mysql主从基本原理" class="headerlink" title="mysql主从基本原理"></a>mysql主从基本原理</h2><p>　　一个主库，可以读写，一个从库可读，不可写。<br>　　流程：一个更新操作：<br>　　１．主库执行更新操作，写入到binlog里面。，备库和主库维持一个长连接。主库内部有个线程，专门用于服务备库的这个长连接。<br>    2.备库通过change master 设置主库A的ip，端口，用户名，密码，以及要从哪个位置来请求binlog，这个位置包含文件名和日志偏移量。<br>　　３．备库执行start slave 命令，这个时候，备库会启动2个线程。一个叫做 io_thread（用来负责和主库建立连接），主库检验完用户名。密码后开始按照备库传过来的位置读取binlog，发送给备库，备库拿到数据后，放到relay log。另一个线程就是sql_thread ，读取relay log.然后执行。<br>　　双主结构：从节点和主节点互为主备关系。切换时不修改主备关系。但是从节点依旧是readonly.互为主备存在循环日志关系，比如a把binlog发给了b，b接受到后吧日志发给了a，如此就循环了，这边方法时每个库的serverid保持不一样，当接受日志的时候，当发现serverid和自己一样时，丢掉日志。</p>
<h2 id="binlog３个格式"><a href="#binlog３个格式" class="headerlink" title="binlog３个格式"></a>binlog３个格式</h2><p>　　statement：记录原语句。<br>　　row：记录的是修改后的动作。比如删除 id=1,新增 id2=2等信息。直接记录的就是数据.<br>　　mix：混合上面2个格式的。为何有这种格式呢？statement，直接执行语句可能导致报错，而row占的空间太大。使用mix，不存在歧义的语句采用statement,存在歧义的使用row。<br>　　歧义sql:<br>　　 delete from t   where a&gt;=4 and t_modified&lt;=’2018-11-10’ limit 1;<br>　　其可能使用ａ这个索引，或者t_modified这个索引。采用不同索引，可能删除的数据不一样。<br>　　row格式日志其保存了修改前后的变化，如果误操作了，可以查看回滚。所以一般都是用这个row这种格式来记录binlog。如果用statement格式的binlog恢复数据时，要先用mysqlbinlog解析出来，再把结果发给mysql执行。</p>
<h2 id="主备延迟"><a href="#主备延迟" class="headerlink" title="主备延迟"></a>主备延迟</h2><p>　　每个事务都有一个时间，这个时间就是主库写入时间，而主备延迟是从库写入的系统时间，减去这个主库写入时间的差值。这个时间值一般来源于，从库接受到数据，到写入到从库的时间。网络影响较小。<br>　　原因如下：<br>　　１.由于备库没有请求，于是给备库配置的机器极差，但是，备库同步数据时，对磁盘的操作也是有的，更新操作也很多，因此，造成了大量的延迟。<br>　　２．让备库去处理请求，由于考虑到只是读请求，因此不加限制，导致备库同步数据慢。<br>　　　针对原因２解决方案：<br>　　　１：增加几个从库<br>　　　２．将信息binlog输出到外部系统Hadoop来减轻压力。<br>　　　３．大事务，一个大的事务，在主库都执行了很久，何况从库。<br>　　  ４．DDL,ddl会重建表。而大表的重建，性能损耗很大。<br>　　３．备库的并行复制能力</p>
<h2 id="双主切换流程"><a href="#双主切换流程" class="headerlink" title="双主切换流程"></a>双主切换流程</h2><p>　　１．判断延迟时间是否小于一个阈值。否则重复这一步。<br>　　２．将主库改为只读，<br>　　３．判断备库的延迟时间是否为０.<br>　　４．将备库改为可读写。<br>　　５，将请求切换到备库Ｂ．<br>　　其中最耗时的是步骤３，因此我们要控制好步骤一的阈值，从而减少不可用时间。　按照这个步骤可以让可靠性达到最高。，但是可用性会随之下降。假设先执行４．５步骤，可用性最高，一直可用，主库插入一个数据４，主键自增，（１,４）。然后切换主备，这个（１,４）没有写入到从库，然后新增数据５，从库存了（１,５）然后，接受到存４，存了（２,４）然后主从数据库不一致了。　　　如果是row格式的binlog，那就不是数据不一致，那是数据根本存不进去。<br>　　如果发生异常，主库宕机了，而从库延迟时间极长，那么切换为从库，会造成系统长时间不可用。因此mysql高可用是建立在延迟时间短的情况下的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/04/16/maven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/16/maven/" itemprop="url">maven</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-16T09:22:50+08:00">
                2019-04-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="约定配置"><a href="#约定配置" class="headerlink" title="约定配置"></a>约定配置</h2><p>　　maven约定大于配置：<br>　　${basedir}    存放pom.xml和所有的子目录<br>　　${basedir}/src/main/java    项目的java源代码<br>　　${basedir}/src/main/resources    项目的资源，比如property文件，springmvc.xml<br>　　${basedir}/src/test/java    项目的测试类，比如说Junit代码<br>　　${basedir}/src/test/resources    测试用的资源<br>　　${basedir}/src/main/webapp/WEB-INF    web应用文件目录，web项目的信息，比如存放web.xml、本地图片、jsp视图页面<br>　　${basedir}/target    打包输出目录<br>　　${basedir}/target/classes    编译输出目录<br>　　${basedir}/target/test-classes    测试编译输出目录<br>　　Test.java    Maven只会自动运行符合该命名规则的测试类<br>　　~/.m2/repository    Maven默认的本地仓库目录位置。</p>
<h2 id="pom"><a href="#pom" class="headerlink" title="pom"></a>pom</h2><h3 id="pom基本标签简介"><a href="#pom基本标签简介" class="headerlink" title="pom基本标签简介"></a>pom基本标签简介</h3><p>　　groupId：公司或者组织的唯一标志，并且配置时生成的路径也是由此生成， 如<br>　　<groupid>com.companyname.project-group</groupid>，maven会将该项目打成的jar包放本地路径：/com/companyname/project-group<br>　　artifactId：项目的唯一ID，一个groupId下面可能多个项目，就是靠artifactId来区分的。<br>　　version：版本号。<br>　　project：工程的根标签。<br>　　modelVersion：模型版本，基本都是4.0</p>
<h3 id="父pom"><a href="#父pom" class="headerlink" title="父pom"></a>父pom</h3><p>　　所有的pom都要继承一个父pom。父pom声明了一些可被继承的默认设置。maven使用effective pom(父pom+自己工程pom的配置)来执行目标，目的是为了尽可能减少配置。
　　</p>
<h2 id="maven生命周期"><a href="#maven生命周期" class="headerlink" title="maven生命周期"></a>maven生命周期</h2><p>　　validate：验证项目是否正确且所有必须信息是可用的。</p>
<p>　　compile：执行编译    源代码编译在此阶段完成。</p>
<p>　　Test：使用适当的单元测试框架（例如JUnit）运行测试</p>
<p>　　package：打包创建JAR/WAR包如在 pom.xml 中定义提及的包</p>
<p>　　verify：    检查    对集成测试的结果进行检查，以保证质量达标</p>
<p>　　install：安装安装打包的项目到本地仓库，以供其他项目使用</p>
<p>　　deploy：    部署    拷贝最终的工程包到远程仓库中，以共享给其他开发人员和工程</p>
<h2 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h2><p>　　Maven根据坐标寻找构件的时候，它先会查看本地仓库，如果本地仓库存在构件，则直接使用；如果没有，则从远程仓库查找，找到后，下载到本地。</p>
<p>　　分类</p>
<p>　　本地仓库</p>
<p>　　远程仓库：</p>
<p>　　中央仓库：默认的远程仓库。maven的setting文件有个父pom,在你安装的maven的lib下的 maven-model-builde-xxx.jar解压，然后不断点击进入，找到super pom里面配置了一个id为central的中央仓库。</p>
<p>　　私服：私服是一种特殊的远程Maven仓库，它是架设在局域网内的仓库服务，私服一般被配置为互联网远程仓库的镜像，供局域网内的Maven用户使用。当Maven需要下载构件的时候，先向私服请求，如果私服上不存在该构件，则从外部的远程仓库下载，同时缓存在私服之上，然后为Maven下载请求提供下载服务，另外，对于自定义或第三方的jar可以从本地上传到私服，供局域网内其他maven用户使用。<br>　　profile。</p>
<p>　　普通远程仓库。</p>
<p>　　每个用户只能有一个本地仓库，和多个远程仓库。</p>
<p>　　maven镜像：</p>
<p>　　当远程仓库被镜像匹配到，那么获取jar将从镜像仓库获取，而不是我们配置的repository仓库。</p>
<p>　　ps：这个镜像，个人觉得，类似于拦截器，用于拦截父pom，以及你项目配置的仓库。拦截后使用，setting文件里面的pom文件。没有匹配到远程仓库的毫无意义。匹配到的则是替换。因此远程仓库和镜像是一个级别。</p>
<p>　　获取jar的优先级。</p>
<p>　　本地仓库 &gt; 私服 （profile）&gt; 远程仓库（repository）和 镜像 （mirror） &gt; 中央仓库 （central）</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/01/28/es 入门2.0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/28/es 入门2.0/" itemprop="url">es 入门2.0</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-28T10:21:06+08:00">
                2019-01-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="2种通信方式"><a href="#2种通信方式" class="headerlink" title="2种通信方式"></a>2种通信方式</h2><p>　　我们有２个方式和服务端集群交互，第一个是通过9300端口并使用Elasticsearch原生传输协议和集群交互，同时集群的节点也是通过这个端口彼此通信的。这个只能通过java实现，同时maven依赖版本必须和es版本保持一致，不然可能连不上去。第二个方式就是其他语言包括java都可以使用的，就是通过restful api 9200端口和Elasticsearch交互。  </p>
<h2 id="查询性能"><a href="#查询性能" class="headerlink" title="查询性能"></a>查询性能</h2><p>　　１．ES的搜索引擎严重依赖于底层的filesystem cache，你如果给filesystem cache更多的内存，尽量让内存可以容纳所有的idx segment file索引数据文件，那么你搜索的时候就基本都是走内存的，性能会非常高。一般来说，内存空间要达到磁盘数据量的一般，使用es性能才好。<br>　　２.在es中，如果内存留给filesystem cache的空间是1g，那么你的索引数据就要控制在1g以内，那么你的数据几乎都是走内存来搜索，性能极高。比如你只需要根据id，name,age3个字段来搜索，但是你把一行数据30多个字段都丢进去了，那么有大量的数据不是用来搜索的，占了filesystem cache的空间，浪费了。因此我们建议将id+name,age,其余的数据存在mysql里面，然后通过索引再mysql里面查询。<br>　　３．数据预热，可以搞个子系统，手动访问某些数据，将数据加热，提前刷到filesystem cache里面。<br>　　４．es深度分页性能很差，方案，去除深度分页。
　</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/01/21/工作中发现的代码不良习惯/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/21/工作中发现的代码不良习惯/" itemprop="url">工作中发现的代码不良习惯</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-21T11:36:28+08:00">
                2019-01-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>　　接口方法定义不用额外写public abstract,默认即可。</p>
<h2 id="spring注入属性"><a href="#spring注入属性" class="headerlink" title="spring注入属性"></a>spring注入属性</h2><p>　　我们约定了，当需要从配置文件中读取同一批的属性＞３个时，不要使用value来一个个注入，和springboot一样，将其批量放到一个类里面，然后调用。</p>
<pre><code>@Component
@ConfigurationProperties(prefix = &quot;rbapi.rabbitmq&quot;)
@Data
public class RbapiProperties {
       private String  queuename;
       private String  exchangename;
       private String  routingkey;

}
</code></pre><p>　　然后在需要用到这些属性的地方，注解注入这个bean即可。
　　 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/01/17/吾日三省吾身/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/17/吾日三省吾身/" itemprop="url">吾日三省吾身</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-17T10:15:14+08:00">
                2019-01-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="why"><a href="#why" class="headerlink" title="why?"></a>why?</h2><p>　　很忧伤，同一级别年终考核，我是ｄ，领导开头就是级别不代表绝对公正性，然而我还是ｄ，一共ａｂｃｄｅｆ，６级，我在后面的0.5里面。</p>
<h2 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h2><p>　　自身能力不够强，需要改进，领导说的理由，你才来没多久，我们部门是非核心部门，能力不够全面，不仅仅是技术能力，还要人际关系处理，揣摩领导意思！学到了。能力要全面，这个确实是的，我觉得还要有，良好的沟通能力，说话节奏控制住。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/01/17/微服务猜想/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/17/微服务猜想/" itemprop="url">微服务猜想</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-17T09:48:25+08:00">
                2019-01-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="关于代码拆分。"><a href="#关于代码拆分。" class="headerlink" title="关于代码拆分。"></a>关于代码拆分。</h2><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><h4 id="优势："><a href="#优势：" class="headerlink" title="优势："></a>优势：</h4><p>　　1.解耦合，使得代码更加容易扩展升级。标准版的升级只要不是接口的变化，对其他服务影响为0.<br>　　2.领导提出的按图搜房，大量数据的汇总展示。我们维护一个数据源，易于分析，展示。<br>　　3.开放出人力成本，一个人可以维护一个或者多个微服务，极大的节约了人力成本。</p>
<h4 id="劣势："><a href="#劣势：" class="headerlink" title="劣势："></a>劣势：</h4><p>　　1.对开发要求高，以及重构成本。</p>
<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>　　1.整体思路。一个基础中心微服务+多个城市特色微服务。</p>
<p>　　2.基于标准版拆分出多个微服务。每个微服务提供粒子化的对外微服务。<br>　　1.首先，登录模块必须独立出来。作为一个独立的微服务，登录模块拆分出来。<br>　　思路如下：通过不同url访问前端，前端请求该微服务，服务返回token即可。带着该token访问其他微服务即可。<br>　　2.基本工具，基本字典的数据微服务<br>　　3.关于不同端的合同发布，备案，本质上是一个service实现的，可能存在部分字段差，这些可以放在一个微服务里面（同理这些具体业务也可以继续拆分为不同的微服务）更加粒子化。可以让备案，房源，做成对外提供服务的基础组件。<br>　　4.定时器，这个单独的工程可以直接拆到各个微服务里面，比如很多宽表的同步，个人觉得意义不是很大，可以优化。<br>　　3.多个城市特色微服务。一个地方城市就建立一个微服务，其开发工作就是调用基础中心对外的服务的拼装，需要什么就拿什么，就和堆积木一样。如此构成了一个遍布全国的微服务网络。这样服务就可以连起来了。数据也统一起来了。</p>
<h3 id="问题以及解决方案："><a href="#问题以及解决方案：" class="headerlink" title="问题以及解决方案："></a>问题以及解决方案：</h3><h4 id="1-数据库字段差异："><a href="#1-数据库字段差异：" class="headerlink" title="1.数据库字段差异："></a>1.数据库字段差异：</h4><p>　　方案1:中心数据库冗余存储一个字段json类型，可以冗余存储多个字段。<br>　　方案2：中心保存最重要的数据，特色城市在维护一个冗余表保存特色字段（存在分布式事务问题）</p>
<h4 id="2-流程差异，比如，特色城市里面是一证多房的问题，就要大改"><a href="#2-流程差异，比如，特色城市里面是一证多房的问题，就要大改" class="headerlink" title="2.流程差异，比如，特色城市里面是一证多房的问题，就要大改"></a>2.流程差异，比如，特色城市里面是一证多房的问题，就要大改</h4><p>　　方案1：基础中心产品评判这个功能是否普遍性较高，若是很高，加入到基础中心微服务里面，反之，特色微服务自己实现一遍，同时把数据也拼装到基础中心（差异太大，没办法，就是相当于重做了，没有的办法）。</p>
<h3 id="3-大量差异很小的工程。"><a href="#3-大量差异很小的工程。" class="headerlink" title="3.大量差异很小的工程。"></a>3.大量差异很小的工程。</h3><p>　　方案1：基础中心设计一个基于配置化的功能，开发在上面点击选择后，可以迅速生成一个简单的脚手架，加速开发，而不是纯粹的复制，减少了大量开发工作。</p>
<h3 id="4-新功能"><a href="#4-新功能" class="headerlink" title="4.新功能"></a>4.新功能</h3><p>　　如若有新的功能，可以由保准化产品定论是否标准化，标准化后再提供微服务调用。</p>
<p>后续新增。每周更新</p>
<h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><p>　　1.前端同学开发应该是基于antd组件的，可以建议开发一个界面设计器。界面设计器的目的是减少前端的开发量，将html和js分离，界面设计器的概念是我们在界面上配置界面展示如何。然后我们根据配置界面后得到的唯一标识符，只负责编写业务逻辑js代码，可以有效提高前端在新业务上开发的效率。</p>
<h2 id="公有云和私有云"><a href="#公有云和私有云" class="headerlink" title="公有云和私有云"></a>公有云和私有云</h2><p>　　我们可以使用混合云的思路和模式，很多对外城市开发的产品，大多数城市对安全要求很严谨。因此我们不可能将其作为一个微服务放到大的微服务集群里面，因为这是在公有云体系里面，这样安全存在问题，我们必须使用私有云服务体系，将当前这个城市需要的微服务，我们将其提取出来，放到一个私有云里面。然后将其组装为该城市需要的系统，如此既保证了安全的特性，又保证了服务的可用性。</p>
<h2 id="直接复制代码的缺陷"><a href="#直接复制代码的缺陷" class="headerlink" title="直接复制代码的缺陷"></a>直接复制代码的缺陷</h2><p>　　定制化存在这么一个问题，你提供的标准版是稳定的吗？第一可能存在bug,安全漏斗等问题，第二可能存在二次迭代更新，业务定制方也有特色开发，如此造成2个分流的分支，将来如何能合在一起呢？这也是我们公司目前的方案，所以我写了2篇文章来思考新的方案。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://skydh.github.io/2019/01/17/定制化猜想/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="董航">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="why are you so happy">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/17/定制化猜想/" itemprop="url">定制化猜想</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-17T09:47:50+08:00">
                2019-01-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题？"><a href="#问题？" class="headerlink" title="问题？"></a>问题？</h2><p>公司预定义一个标准化的saas服务。预先面向A公司（行业龙头，因此具有 一定规范度）提供标准化开发（产品与A公司专门业务人员沟通，提取出公 共化方案）。成功上线后，推广到其他公司b,c,d。发现其他公司的内部流程 算法，界面不适应于标准化版本。</p>
<h2 id="方案。"><a href="#方案。" class="headerlink" title="方案。"></a>方案。</h2><p>建立组织层级，建立一个微服务档案列表，不同集团对应不同层级同时和登 录信息绑定。对于存在差异的算法（计算公式，是否采用不同方案）等，界 面显示（字段，按钮）等，单线流程（a公司是否需要流程123,但是b公司需 要流程1,3）等，在需要修改的点，以及这个组织id,在档案里面进行配置，不 同组织不同的方案，然后代码读取档案里面的信息，根据档案里面的这些信 息来完成差异统一。这样我们就可以用一个标准化版本了。上述档案归产品 经理管，负责维护（重要） 　　有些公司对于样式，布局等要求频繁变化，我们可以推出一部分档案权 限给客户，让其自行进行配置选择展示效果。</p>
<h2 id="问题？-1"><a href="#问题？-1" class="headerlink" title="问题？"></a>问题？</h2><p>在开发中，我们发现一个线的流程太长了，比如开发Ａ功能，在Ａ功能界面 上需要但需要获取调用其他功能比如Ｂ的数据信息展示而这些数据信息却放 在其他微服务里面，我们也许会直接发送ajax请求其他微服务的信息，但是 存在几个问题（1.即时我们共用一个登陆系统，可以直接把登陆信息放到请 求头里面，可以直接访问到数据，但是这样不规范，A微服务前端访问到了B 微服务的后端，即使在一个微服务里面，我们直接访问其他功能的数据，这 样也不规范，也不好维护，万一这个接口修改了，修改的人也不知道到底多 少人调用了这个接口，怎么调用的等很多问题）</p>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>参照这个功能解决上述问题。每个功能可以对外提供一个或者多个的数据接 口。 　　该功能结构主要包含下述几点： 　　１．一个包含增删改查的一个存储数据的界面。主要存放：该功能对外 提供的rest接口，需要展示的数据类型，界面展示风格（树表，列表，树， 主要这几个结构）。 　　２．一个前端组件：通过开发配置的信息，展示数据。并且前端也可以 获取数据等。 　　这样界面调用展示数据，更加利于维护。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">董航</p>
              <p class="site-description motion-element" itemprop="description">clear 航</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">113</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">董航</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
